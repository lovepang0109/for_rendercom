import{W as he,bz as ge,bA as ye,bB as ke,bC as Ve,aw as Ce,Z as be,aA as we,k as R,a8 as T,a5 as O,a7 as y,bD as Fe,aB as Ie,bE as Ae,bF as Se,bG as xe,B as j,al as q,a0 as Pe,U as J,p as n,F as E,L as De,S as L,M as Me,N as Q,bH as _e,C as X,bd as Re,aM as Te,P as Le,bI as Ee,ak as Be}from"./index.84400ea8.js";function Ue(l,p,a){if(p==null)return l;if(Array.isArray(p))throw new Error("Multiple matches is not implemented");return typeof p=="number"&&~p?n(E,null,[n("span",{class:"v-autocomplete__unmask"},[l.substr(0,p)]),n("span",{class:"v-autocomplete__mask"},[l.substr(p,a)]),n("span",{class:"v-autocomplete__unmask"},[l.substr(p+a)])]):l}const Ne=he({autoSelectFirst:{type:[Boolean,String]},search:String,...ge({filterKeys:["title"]}),...ye(),...ke(Ve({modelValue:null}),["validationValue","dirty","appendInnerIcon"]),...Ce({transition:!1})},"VAutocomplete"),Oe=be()({name:"VAutocomplete",props:Ne(),emits:{"update:focused":l=>!0,"update:search":l=>!0,"update:modelValue":l=>!0,"update:menu":l=>!0},setup(l,p){let{slots:a}=p;const{t:Y}=we(),k=R(),V=T(!1),h=T(!0),x=R(!1),z=R(),B=O(l,"menu"),v=y({get:()=>B.value,set:e=>{var t;B.value&&!e&&((t=z.value)==null?void 0:t.\u03A8openChildren)||(B.value=e)}}),o=T(-1),ee=y(()=>{var e;return(e=k.value)==null?void 0:e.color}),{items:U,transformIn:le,transformOut:ae}=Fe(l),{textColorClasses:te,textColorStyles:ue}=Ie(ee),r=O(l,"search",""),m=O(l,"modelValue",[],e=>le(Ae(e)),e=>{var s;const t=ae(e);return l.multiple?t:(s=t[0])!=null?s:null}),F=Se(),{filteredItems:P,getMatches:ne}=xe(l,U,y(()=>h.value?void 0:r.value)),g=y(()=>m.value.map(e=>U.value.find(t=>l.valueComparator(t.value,e.value))||e)),b=y(()=>l.hideSelected?P.value.filter(e=>!g.value.some(t=>t.value===e.value)):P.value),N=y(()=>g.value.map(e=>e.props.value)),H=y(()=>g.value[o.value]),D=y(()=>{var t;return(l.autoSelectFirst===!0||l.autoSelectFirst==="exact"&&r.value===((t=b.value[0])==null?void 0:t.title))&&b.value.length>0&&!h.value&&!x.value}),K=y(()=>l.hideNoData&&!U.value.length||l.readonly||(F==null?void 0:F.isReadonly.value)),$=R();function oe(e){l.openOnClear&&(v.value=!0),r.value=""}function se(){K.value||(v.value=!0)}function ie(e){K.value||(V.value&&(e.preventDefault(),e.stopPropagation()),v.value=!v.value)}function ce(e){var w,u,c;if(l.readonly||(F==null?void 0:F.isReadonly.value))return;const t=k.value.selectionStart,s=N.value.length;if((o.value>-1||["Enter","ArrowDown","ArrowUp"].includes(e.key))&&e.preventDefault(),["Enter","ArrowDown"].includes(e.key)&&(v.value=!0),["Escape"].includes(e.key)&&(v.value=!1),["Enter","Escape","Tab"].includes(e.key)&&(D.value&&["Enter","Tab"].includes(e.key)&&I(P.value[0]),h.value=!0),e.key==="ArrowDown"&&D.value&&((w=$.value)==null||w.focus("next")),!!l.multiple){if(["Backspace","Delete"].includes(e.key)){if(o.value<0){e.key==="Backspace"&&!r.value&&(o.value=s-1);return}const i=o.value;H.value&&I(H.value),o.value=i>=s-1?s-2:i}if(e.key==="ArrowLeft"){if(o.value<0&&t>0)return;const i=o.value>-1?o.value-1:s-1;g.value[i]?o.value=i:(o.value=-1,k.value.setSelectionRange((u=r.value)==null?void 0:u.length,(c=r.value)==null?void 0:c.length))}if(e.key==="ArrowRight"){if(o.value<0)return;const i=o.value+1;g.value[i]?o.value=i:(o.value=-1,k.value.setSelectionRange(0,0))}}}function re(e){var t;e.key==="Tab"&&((t=k.value)==null||t.focus())}function ve(e){r.value=e.target.value}function de(){var e;V.value&&(h.value=!0,(e=k.value)==null||e.focus())}function fe(e){V.value=!0,setTimeout(()=>{x.value=!0})}function me(e){x.value=!1}function pe(e){(e==null||e===""&&!l.multiple)&&(m.value=[])}const S=T(!1);function I(e){if(l.multiple){const t=N.value.findIndex(s=>l.valueComparator(s,e.value));if(t===-1)m.value=[...m.value,e];else{const s=[...m.value];s.splice(t,1),m.value=s}}else m.value=[e],S.value=!0,r.value=e.title,v.value=!1,h.value=!0,q(()=>S.value=!1)}return j(V,(e,t)=>{var s,w;e!==t&&(e?(S.value=!0,r.value=l.multiple?"":String((w=(s=g.value.at(-1))==null?void 0:s.props.title)!=null?w:""),h.value=!0,q(()=>S.value=!1)):(!l.multiple&&!r.value?m.value=[]:D.value&&!x.value&&!g.value.some(u=>{let{value:c}=u;return c===b.value[0].value})&&I(b.value[0]),v.value=!1,r.value="",o.value=-1))}),j(r,e=>{!V.value||S.value||(e&&(v.value=!0),h.value=!e)}),Pe(()=>{const e=!!(l.chips||a.chip),t=!!(!l.hideNoData||b.value.length||a["prepend-item"]||a["append-item"]||a["no-data"]),s=m.value.length>0,[w]=J.filterProps(l);return n(J,L({ref:k},w,{modelValue:r.value,"onUpdate:modelValue":pe,focused:V.value,"onUpdate:focused":u=>V.value=u,validationValue:m.externalValue,dirty:s,onInput:ve,class:["v-autocomplete",`v-autocomplete--${l.multiple?"multiple":"single"}`,{"v-autocomplete--active-menu":v.value,"v-autocomplete--chips":!!l.chips,"v-autocomplete--selection-slot":!!a.selection,"v-autocomplete--selecting-index":o.value>-1},l.class],style:l.style,readonly:l.readonly,placeholder:s?void 0:l.placeholder,"onClick:clear":oe,"onMousedown:control":se,onKeydown:ce}),{...a,default:()=>n(E,null,[n(De,L({ref:z,modelValue:v.value,"onUpdate:modelValue":u=>v.value=u,activator:"parent",contentClass:"v-autocomplete__content",disabled:K.value,eager:l.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:l.transition,onAfterLeave:de},l.menuProps),{default:()=>[t&&n(Me,{ref:$,selected:N.value,selectStrategy:l.multiple?"independent":"single-independent",onMousedown:u=>u.preventDefault(),onKeydown:re,onFocusin:fe,onFocusout:me,tabindex:"-1"},{default:()=>{var u,c,i,C;return[(u=a["prepend-item"])==null?void 0:u.call(a),!b.value.length&&!l.hideNoData&&((i=(c=a["no-data"])==null?void 0:c.call(a))!=null?i:n(Q,{title:Y(l.noDataText)},null)),b.value.map((d,A)=>{var G,W;const f=L(d.props,{key:A,active:D.value&&A===0?!0:void 0,onClick:()=>I(d)});return(W=(G=a.item)==null?void 0:G.call(a,{item:d,index:A,props:f}))!=null?W:n(Q,f,{prepend:M=>{let{isSelected:_}=M;return n(E,null,[l.multiple&&!l.hideSelected?n(_e,{key:d.value,modelValue:_,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependIcon&&n(X,{icon:d.props.prependIcon},null)])},title:()=>{var M,_,Z;return h.value?d.title:Ue(d.title,(M=ne(d))==null?void 0:M.title,(Z=(_=r.value)==null?void 0:_.length)!=null?Z:0)}})}),(C=a["append-item"])==null?void 0:C.call(a)]}})]}),g.value.map((u,c)=>{var d,A;function i(f){f.stopPropagation(),f.preventDefault(),I(u)}const C={"onClick:close":i,onMousedown(f){f.preventDefault(),f.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0};return n("div",{key:u.value,class:["v-autocomplete__selection",c===o.value&&["v-autocomplete__selection--selected",te.value]],style:c===o.value?ue.value:{}},[e?a.chip?n(Te,{key:"chip-defaults",defaults:{VChip:{closable:l.closableChips,size:"small",text:u.title}}},{default:()=>{var f;return[(f=a.chip)==null?void 0:f.call(a,{item:u,index:c,props:C})]}}):n(Re,L({key:"chip",closable:l.closableChips,size:"small",text:u.title},C),null):(A=(d=a.selection)==null?void 0:d.call(a,{item:u,index:c}))!=null?A:n("span",{class:"v-autocomplete__selection-text"},[u.title,l.multiple&&c<g.value.length-1&&n("span",{class:"v-autocomplete__selection-comma"},[Le(",")])])])})]),"append-inner":function(){var C;for(var u=arguments.length,c=new Array(u),i=0;i<u;i++)c[i]=arguments[i];return n(E,null,[(C=a["append-inner"])==null?void 0:C.call(a,...c),l.menuIcon?n(X,{class:"v-autocomplete__menu-icon",icon:l.menuIcon,onMousedown:ie,onClick:Ee},null):void 0])}})}),Be({isFocused:V,isPristine:h,menu:v,search:r,filteredItems:P,select:I},k)}});export{Oe as V};
